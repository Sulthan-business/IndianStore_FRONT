<div class="tracking-container">
  <div class="glass-card" *ngIf="fulfillmentData(); else loading">
    <div class="header">
      <h2>Track Your Happiness</h2>
      <p class="order-no">Order #{{ orderId }}</p>
    </div>

    <div class="stepper">
      <div class="step" [class.completed]="true">
        <div class="circle"><i class="icon">âœ”</i></div>
        <span>Placed</span>
        <div class="line"></div>
      </div>
      
      <div class="step" [class.completed]="['ACCEPTED', 'SHIPPED', 'DELIVERED'].includes(fulfillmentData().status)">
        <div class="circle"><i class="icon">âš™</i></div>
        <span>Processing</span>
        <div class="line"></div>
      </div>

      <div class="step" 
           [class.completed]="['SHIPPED', 'DELIVERED'].includes(fulfillmentData().status)"
           [class.running]="fulfillmentData().status === 'SHIPPED'">
        <div class="circle"><i class="icon">ğŸšš</i></div>
        <span>Shipped</span>
        <div class="line"></div>
      </div>

      <div class="step" [class.completed]="fulfillmentData().status === 'DELIVERED'">
        <div class="circle"><i class="icon">ğŸ</i></div>
        <span>Delivered</span>
      </div>
    </div>

    <div class="details-pane" *ngIf="fulfillmentData().status === 'SHIPPED' || fulfillmentData().status === 'DELIVERED'">
      <div class="tracking-info">
        <div class="info-box">
          <small>Courier Partner</small>
          <strong>{{ fulfillmentData().carrier || 'Searching...' }}</strong>
        </div>
        <div class="info-box">
          <small>Tracking ID</small>
          <strong>{{ fulfillmentData().tracking_no || 'Pending' }}</strong>
        </div>
      </div>
      
      <a *ngIf="fulfillmentData().tracking_url" [href]="fulfillmentData().tracking_url" target="_blank" class="live-btn">
        Live Tracking Link
      </a>
    </div>

    <div class="status-msg" *ngIf="fulfillmentData().status !== 'DELIVERED'">
      <p>Status: <span>{{ fulfillmentData().status }}</span></p>
    </div>
  </div>

  <ng-template #loading>
    <div class="delivery-loader">
      <div class="road">
        <div class="truck">ğŸšš</div>
      </div>
      <p>Locating your package in the clouds...</p>
    </div>
  </ng-template>
</div>